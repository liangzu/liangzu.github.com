<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>See your data structures(c++)</title>
<!-- 2016-09-07 Wed 15:56 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Liangzu Peng" />
<link rel="stylesheet" href="./css/my-css.css" type="text/css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">See your data structures(c++)</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Introduction</a></li>
<li><a href="#sec-2">Advice</a>
<ul>
<li><a href="#sec-2-1">Understanding c-style string</a></li>
<li><a href="#sec-2-2">Understanding c pointer</a></li>
<li><a href="#sec-2-3">Understanding memory leaks.</a>
<ul>
<li><a href="#sec-2-3-1">What memory leak looks like?</a></li>
<li><a href="#sec-2-3-2">Does memory leak matter in your data structure practice?</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-3">Visualization</a></li>
</ul>
</div>
</div>
<blockquote>
<p>
"<i>I see trees but not the forest.</i>"
</p>

<p>
&#x2014;&#x2014; <i>I</i>
</p>
</blockquote>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
There are some drawbacks that teaching data structures using c or c++:
</p>
<ul class="org-ul">
<li>Manual management of memory brings some unnecessary complexity;
</li>
<li>The lack of boundry checking and unfamiliarity of c-style string always lead some well-known problems, e.g., segment-fault, "烫烫烫";
</li>
<li>There are no built-in 2-D graphic libraries in c or c++, and hence there are no visual method to debug your algorithm.
</li>
</ul>

<p>
Those drawbacks prevent the students from touching the nature of data structures， and also tear down the passion of students.
Some well-designed courses（e.g., <a href="http://web.stanford.edu/class/cs106b/">Stanford cs106b</a>) provide a framework in assignments/labs so that the students can focus on their
own duties. But, unfortunately, there are still many students(e.g., the younger me) fight with the drakbacks and learn something
but not data structures.
</p>

<p>
This article shares some advice while facing data structures and introduces a simple approach visualizing your data structures.
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Advice</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Understanding c-style string</h3>
<div class="outline-text-3" id="text-2-1">
<p>
try to implement some string-related library functions, e.g., <i>strcpy</i>, <i>strlen</i>, <i>strcmp</i>, <i>atoi</i>, <i>itoa</i>.
</p>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Understanding c pointer</h3>
<div class="outline-text-3" id="text-2-2">
<p>
implement some pointer-related functions:
</p>
<ul class="org-ul">
<li>rewrite your function using pointers instead of arrays.
</li>
<li>implement <code>Swap(void* a, void* b, size_t n)</code>, where a and b are the same type, and n is the size of a( or b). your implementation should work while the type of a is <code>char**</code> and <code>int</code>, respectively. As a hint, try to use <code>memcpy</code>.
</li>
<li>implement <code>Compare(void*a, void* b, size_t n)</code>. hint:  use <code>memcmp</code>;
</li>
<li>(optional) implement <code>qsort(void** v, int left, int right, int (*comp) (void *, void *))</code>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Understanding memory leaks.</h3>
<div class="outline-text-3" id="text-2-3">
<p>
It always has been heard that a dummy programmer wrote some naive code and leaked the memory, resulting in great losses of his company.
We got a plausible impression from this story: "memory leak is evil, we should be careful of it.".
</p>

<p>
such this impression is right, when you write product-level code or some program that run forever on the server; but wrong, when you practice
data structures in hundreds of lines code. We should focus on the things itself when learning something(data structures), instead of others(memory management).
</p>

<p>
Let me illustrate this idea with some examples:
</p>
</div>

<div id="outline-container-sec-2-3-1" class="outline-4">
<h4 id="sec-2-3-1">What memory leak looks like?</h4>
<div class="outline-text-4" id="text-2-3-1">
<div class="org-src-container">

<pre class="src src-c++"><span style="color: #7FFFD4;">void</span> <span style="color: #1D68C4;">ugly</span><span style="color: #e91e63;">()</span>
<span style="color: #e91e63;">{</span>
    <span style="color: #7FFFD4;">int</span>* <span style="color: #ffffaa;">leaker</span> = <span style="color: #5FB7CC;">new</span> <span style="color: #7FFFD4;">int</span><span style="color: #1565C0;">()</span>;

    use_leaker<span style="color: #1565C0;">()</span>;

    <span style="color: #a5a5a5;">// </span><span style="color: #a5a5a5;">forget to delete leaker when exit</span>
<span style="color: #e91e63;">}</span>
</pre>
</div>
<p>
There is no way to reference <code>leaker</code> when <code>ugly()</code> exits, but the memory being <code>new</code> will never return to the system util the program is over.
We call this phenomenon <i>memory leak</i>.
What if <code>ugly()</code> is called many times?
</p>
<div class="org-src-container">

<pre class="src src-c++"><span style="color: #7FFFD4;">void</span> <span style="color: #1D68C4;">uglier</span><span style="color: #e91e63;">()</span>
<span style="color: #e91e63;">{</span>
    <span style="color: #5FB7CC;">while</span><span style="color: #1565C0;">(</span><span style="color: #8dd7e9;">true</span><span style="color: #1565C0;">)</span>
    <span style="color: #1565C0;">{</span>
        ugly<span style="color: #EF6C00;">()</span>;
    <span style="color: #1565C0;">}</span>
<span style="color: #e91e63;">}</span>
</pre>
</div>

<p>
Once being called, obviously, <code>uglier()</code> will 'eat' all memory that it can see util your program crumbles.
</p>

<p>
We can prohibit it by <code>delete leaker</code>, or if  <code>leaker</code> may be used by other function, we can return the address of <code>leaker</code>:
</p>
<div class="org-src-container">

<pre class="src src-c++"><span style="color: #7FFFD4;">int</span>* <span style="color: #1D68C4;">ugly</span><span style="color: #e91e63;">()</span>
<span style="color: #e91e63;">{</span>
    <span style="color: #7FFFD4;">int</span>* <span style="color: #ffffaa;">leaker</span> = <span style="color: #5FB7CC;">new</span> <span style="color: #7FFFD4;">int</span><span style="color: #1565C0;">()</span>;

    use_leaker<span style="color: #1565C0;">()</span>;

  <span style="color: #a5a5a5;">// </span><span style="color: #a5a5a5;">delete leaker;</span>
    <span style="color: #5FB7CC;">return</span> leaker;
<span style="color: #e91e63;">}</span>
</pre>
</div>
<p>
new qustions arise: what if <code>use_leaker()</code> throw a <i>exception</i>?
What if the caller of <code>ugly()</code> has no idea about <code>leaker</code> and ignores its return value?
</p>
</div>
</div>

<div id="outline-container-sec-2-3-2" class="outline-4">
<h4 id="sec-2-3-2">Does memory leak matter in your data structure practice?</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
What's data structure? My answer is, data structure cares about the structures and the operations of data in the memory:
</p>
<ul class="org-ul">
<li>How to <b>create</b> the specified structure in the memory?
</li>
<li>How to <b>insert</b> items into the structure?
</li>
<li>How to <b>delete</b> the specified items,
</li>
<li>How to <b>traverse</b> them?
</li>
<li>What's the <b>cost</b> of these operations? and most importantly,
</li>
<li>What's the <b>trade-off</b> between different data stuctures or algorithms?
</li>
</ul>
<p>
People who are studying data structures should focus on designing their algorithms, memory leaks can be ignored. You will learn that how
to manage the memory in the other courses.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Visualization</h2>
<div class="outline-text-2" id="text-3">
<p>
There is no doubt that the best way to debug is the way that let you "see" something in the memory, or concretely: graphical method.
</p>

<p>
I'd like to introduce a magical software, which used to be my secret weapon. its name is <a href="http://www.graphviz.org/"><i>Graphviz</i></a>!
</p>



<p>
I used to write a program, reading a Pascal source file and storing it as an <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a> into the momery. I used <i>Graphviz</i> to draw my AST for debugging purpose.
Let me show its power to you.
</p>

<p>
The below is what my program reads:
</p>
<div class="org-src-container">

<pre class="src src-pascal"><span style="color: #5FB7CC;">program</span> <span style="color: #1D68C4;">hello</span>;
<span style="color: #7FFFD4;">var</span>
    ans : <span style="color: #7FFFD4;">integer</span>;

<span style="color: #5FB7CC;">function</span> <span style="color: #1D68C4;">gcd</span><span style="color: #e91e63;">(</span>a, b : <span style="color: #7FFFD4;">integer</span><span style="color: #e91e63;">)</span> : <span style="color: #7FFFD4;">integer</span>;
<span style="color: #5FB7CC;">begin</span>
    <span style="color: #5FB7CC;">if</span> b = 0 <span style="color: #5FB7CC;">then</span> <span style="color: #5FB7CC;">begin</span>
        gcd := a;
    <span style="color: #5FB7CC;">end</span>
    <span style="color: #5FB7CC;">else</span> <span style="color: #5FB7CC;">begin</span>
        gcd := gcd<span style="color: #e91e63;">(</span>b , a mod b<span style="color: #e91e63;">)</span>;
    <span style="color: #5FB7CC;">end</span>
    ;
<span style="color: #5FB7CC;">end</span>
;

<span style="color: #5FB7CC;">begin</span>
    ans := gcd<span style="color: #e91e63;">(</span>9 , 36<span style="color: #e91e63;">)</span> * gcd<span style="color: #e91e63;">(</span>3 , 6<span style="color: #e91e63;">)</span>;
    writeln<span style="color: #e91e63;">(</span>ans<span style="color: #e91e63;">)</span>;
<span style="color: #5FB7CC;">end</span>
.
</pre>
</div>

<p>
<a href="./dot.pdf">This link</a> is what I get.
</p>

<p>
In fact, this program can read much more complicated Pascal source file and produce the correct image(in many other file format).
</p>

<div class="center">
<p>
if interested in it, You should learn to use it through the online document, but not here.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Liangzu Peng (<a href="mailto:faithofplz@hotmail.com">faithofplz@hotmail.com</a>)</p>
<p class="date">Date: 2016-09-07 Wed 15:56</p>
</div>
</body>
</html>
