<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2016-05-17 周二 10:54 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>See your data structures(c++)</title>
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Liangzu Peng" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" href="./css/my-css.css" type="text/css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">See your data structures(c++)</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline1">Introduction</a></li>
<li><a href="#orgheadline6">Advice</a>
<ul>
<li><a href="#orgheadline5">what you should know before learning c/c++ version data structures</a></li>
</ul>
</li>
<li><a href="#orgheadline7"></a></li>
</ul>
</div>
</div>
<blockquote>
<p>
"<i>I see trees but not the forest.</i>"
</p>

<p>
&#x2014;&#x2014; <i>I</i>
</p>
</blockquote>


<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1">Introduction</h2>
<div class="outline-text-2" id="text-orgheadline1">
<p>
There are some drawbacks that teaching data structures using c or c++:
</p>
<ul class="org-ul">
<li>Manual management of memory brings some unnecessary complexity;</li>
<li>The lack of boundry checking and unfamiliarity of c-style string always lead some well-known problems, e.g., segment-fault, "烫烫烫";</li>
<li>There are no built-in 2-D graphic libraries in c or c++, and hence there are no visual method to debug your algorithm.</li>
</ul>

<p>
Those drawbacks prevent the students from touching the nature of data structures， and also tear down the passion of students.
Some well-designed courses（e.g., <a href="http://web.stanford.edu/class/cs106b/">Stanford cs106b</a>) provide a framework in assignments/labs so that the students can focus on their
own duties. But, unfortunately, there are still many students(e.g., the younger me) fight with the drakbacks and learn something
but not data structures. 
</p>

<p>
This article shares some advice while facing data structures and introduces a simple approach visualizing your data structures.
</p>
</div>
</div>

<div id="outline-container-orgheadline6" class="outline-2">
<h2 id="orgheadline6">Advice</h2>
<div class="outline-text-2" id="text-orgheadline6">
</div><div id="outline-container-orgheadline5" class="outline-3">
<h3 id="orgheadline5">what you should know before learning c/c++ version data structures</h3>
<div class="outline-text-3" id="text-orgheadline5">
</div><ul class="org-ul"><li><a id="orgheadline2"></a>Understanding c-style string<br  /><div class="outline-text-4" id="text-orgheadline2">
<p>
implement some string-related library functions, e.g., <i>strcpy</i>, <i>strlen</i>, <i>strcmp</i>, <i>atoi</i>, <i>itoa</i>.
</p>
</div></li>
<li><a id="orgheadline3"></a>Understanding c pointer<br  /><div class="outline-text-4" id="text-orgheadline3">
<p>
implement some pointer-related functions:
</p>
<ul class="org-ul">
<li>rewrite your function using pointers instead of arrays.</li>
<li>implement <code>Swap(void* a, void* b, size_t n)</code>, where a and b are the same type, and n is the size of a( or b). your implementation should work while the type of a is <code>char**</code> and <code>int</code>, respectively. As a hint, try to use <code>memcpy</code>.</li>
<li>implement <code>Compare(void*a, void* b, size_t n)</code>. <code>hint</code>:  use <code>memcmp</code>;</li>
<li>(optional) implement <code>qsort(void** v, int left, int right, int (*comp) (void *, void *))</code></li>
</ul>
</div></li>

<li><a id="orgheadline4"></a>Understanding memory leaks.<br  /><div class="outline-text-4" id="text-orgheadline4">
<p>
It always has been heard that a dummy programmer wrote some naive code and leaked the memory, resulting in great losses of his company.
We got a plausible impression from this story: "memory leak is evil, we should be careful of it.".
</p>

<p>
such this impression is right, when you write product-level code or some program that run forever on the server; but wrong, when you practice
data structures in hundreds of lines code. We should focus on the things itself when learning something(data structures), instead of others(memory management). 
</p>

<p>
Let me illustrate this idea with some examples:
</p>

<ul class="org-ul">
<li>What memory leak looks like?</li>
</ul>
<div class="org-src-container">

<pre class="src src-c++"><span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">ugly</span><span style="color: #4f97d7;">()</span>
<span style="color: #4f97d7;">{</span>
  <span style="color: #ce537a; font-weight: bold;">int</span>* <span style="color: #7590db;">leaker</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">int</span><span style="color: #bc6ec5;">()</span>;

  use_leaker<span style="color: #bc6ec5;">()</span>;

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">forget to delete leaker when exit</span>
<span style="color: #4f97d7;">}</span>
</pre>
</div>
<p>
There is no way to reference <code>leaker</code> when <code>ugly()</code> exits, but the memory being <code>new</code> will never return to the system util the program is over.
We call this phenomenon <i>memory leak</i>.
What if <code>ugly()</code> is called many times?
</p>
<div class="org-src-container">

<pre class="src src-c++"><span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">uglier</span><span style="color: #4f97d7;">()</span>
<span style="color: #4f97d7;">{</span>
  <span style="color: #4f97d7; font-weight: bold;">while</span><span style="color: #bc6ec5;">(</span><span style="color: #a45bad;">true</span><span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">{</span>
    ugly<span style="color: #2d9574;">()</span>;
  <span style="color: #bc6ec5;">}</span>
<span style="color: #4f97d7;">}</span>
</pre>
</div>

<p>
obviously, <code>uglier()</code> 'eat' all memory that it can see util your program crumbles.
</p>

<p>
We can prohibit it by <code>delete leaker</code>, or if  <code>leaker</code> may be used by other function, we can return the address of <code>leaker</code>:
</p>
<div class="org-src-container">

<pre class="src src-c++"><span style="color: #ce537a; font-weight: bold;">int</span>* <span style="color: #bc6ec5; font-weight: bold;">ugly</span><span style="color: #4f97d7;">()</span>
<span style="color: #4f97d7;">{</span>
  <span style="color: #ce537a; font-weight: bold;">int</span>* <span style="color: #7590db;">leaker</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">int</span><span style="color: #bc6ec5;">()</span>;

  use_leaker<span style="color: #bc6ec5;">()</span>;

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">delete leaker;</span>
  <span style="color: #4f97d7; font-weight: bold;">return</span> leaker; 
<span style="color: #4f97d7;">}</span>
</pre>
</div>
<p>
new qustions arise: what if <code>use_leaker()</code> throw a <i>exception</i>? 
What if the caller of <code>ugly()</code> has no idea about <code>leaker</code> and ignores its return value?
</p>

<ul class="org-ul">
<li>Does memory leak matter in your data structure practice?</li>
</ul>
<p>
Consider the below function:
</p>
<div class="org-src-container">

<pre class="src src-c++"><span style="color: #4f97d7; font-weight: bold;">private</span>:
  <span style="color: #ce537a; font-weight: bold;">Node</span>* <span style="color: #bc6ec5; font-weight: bold;">Insert</span><span style="color: #4f97d7;">(</span><span style="color: #ce537a; font-weight: bold;">Node</span> *<span style="color: #7590db;">x</span>, <span style="color: #ce537a; font-weight: bold;">keyType</span> <span style="color: #7590db;">k</span>, <span style="color: #ce537a; font-weight: bold;">valType</span> <span style="color: #7590db;">v</span><span style="color: #4f97d7;">)</span> <span style="color: #4f97d7; font-weight: bold;">const</span>
  <span style="color: #4f97d7;">{</span>
    <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>x == <span style="color: #a45bad;">nullptr</span><span style="color: #bc6ec5;">)</span>
      <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Node</span><span style="color: #bc6ec5;">(</span>k, v<span style="color: #bc6ec5;">)</span>;
    <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>k &lt; x-&gt;key<span style="color: #bc6ec5;">)</span>
    <span style="color: #bc6ec5;">{</span>
      x-&gt;left = Insert<span style="color: #2d9574;">(</span>x-&gt;left, k, v<span style="color: #2d9574;">)</span>;
    <span style="color: #bc6ec5;">}</span>
    <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>k &gt; x-&gt;key<span style="color: #bc6ec5;">)</span>
    <span style="color: #bc6ec5;">{</span>
      x-&gt;right = Insert<span style="color: #2d9574;">(</span>x-&gt;right, k, v<span style="color: #2d9574;">)</span>;
    <span style="color: #bc6ec5;">}</span>
    <span style="color: #4f97d7; font-weight: bold;">else</span>
    <span style="color: #bc6ec5;">{</span> <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">the key to be inserted already exists...</span>
      x-&gt;val = v;
    <span style="color: #bc6ec5;">}</span>
    x-&gt;size = Size<span style="color: #bc6ec5;">(</span>x-&gt;left<span style="color: #bc6ec5;">)</span> + Size<span style="color: #bc6ec5;">(</span>x-&gt;right<span style="color: #bc6ec5;">)</span> + <span style="color: #a45bad;">1</span>;
    <span style="color: #4f97d7; font-weight: bold;">return</span> x;
  <span style="color: #4f97d7;">}</span>
<span style="color: #4f97d7; font-weight: bold;">public</span>:
  <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Insert</span><span style="color: #4f97d7;">(</span><span style="color: #ce537a; font-weight: bold;">keyType</span> <span style="color: #7590db;">k</span>, <span style="color: #ce537a; font-weight: bold;">valType</span> <span style="color: #7590db;">v</span><span style="color: #4f97d7;">)</span>
  <span style="color: #4f97d7;">{</span>
    root = Insert<span style="color: #bc6ec5;">(</span>root, k, v<span style="color: #bc6ec5;">)</span>;
  <span style="color: #4f97d7;">}</span>
</pre>
</div>
<p>
<code>Insert</code> is a method in <i>BinaryTree</i>, do you see the fifth line: <b>return new Node(k, v);</b>? <code>private: Insert</code> drops the 'responsibility'
of memory management to its caller, while the <code>public: Insert</code> says: <b>root = Insert(root, k, v)</b>, that is, "let <code>root</code> memorize the location
of all nodes".
</p>

<p>
When to release the memory of all nodes? Good question for serious programmer, but not good enough. 
You should ask yourself first:"Must I release the memory?". 
</p>

<p>
Keep in mind that we are practicing data structure! What's data structure?
My answer is, data structure cares about the structure/orgnization of data in the memory: how to create the specified structure in the memory?
how to <b>insert</b> items into the structure, how to <b>delete</b> the specified items, how to <b>traverse</b> them, what's the cost of traversal or other operations?
What's the <b>trade-off</b> between different data stuctures or algorithms?
</p>
</div></li></ul>
</div>
</div>
<div id="outline-container-orgheadline7" class="outline-2">
<h2 id="orgheadline7"></h2>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Liangzu Peng (<a href="mailto:faithofplz@hotmail.com">faithofplz@hotmail.com</a>)</p>
<p class="date">Date: 2016-05-17 周二 10:54</p>
</div>
</body>
</html>
